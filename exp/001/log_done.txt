[2019-01-16 20:41:00]: ================================================
[2019-01-16 20:41:00]: initialize the TRAINER
[2019-01-16 20:41:00]: ================================================
[2019-01-16 20:41:00]: build the model
[2019-01-16 20:41:02]: model summary:
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, None, 257)         0         
_________________________________________________________________
bidirectional_1 (Bidirection (None, None, 600)         1339200   
_________________________________________________________________
bidirectional_2 (Bidirection (None, None, 600)         2162400   
_________________________________________________________________
bidirectional_3 (Bidirection (None, None, 600)         2162400   
_________________________________________________________________
bidirectional_4 (Bidirection (None, None, 600)         2162400   
_________________________________________________________________
embed_audio (TimeDistributed (None, None, 5140)        3089140   
_________________________________________________________________
reshape_1 (Reshape)          (None, None, 257, 20)     0         
_________________________________________________________________
reshape_2 (Reshape)          (None, None, 20)          0         
_________________________________________________________________
lambda_1 (Lambda)            (None, None, 20)          0         
_________________________________________________________________
reshape_3 (Reshape)          (None, None, 257, 20)     0         
=================================================================
Total params: 10,915,540
Trainable params: 10,915,540
Non-trainable params: 0
_________________________________________________________________
[2019-01-16 20:41:02]: finish building the model
[2019-01-16 20:41:02]: load the data from h5 files
[2019-01-16 20:41:02]: finish loading train data from: ../../../data_voice_separation/DSD100/h5/train.h5
[2019-01-16 20:41:02]: total number of train data samples: 1105
[2019-01-16 20:41:02]: finish loading valid data from: ../../../data_voice_separation/DSD100/h5/valid.h5
[2019-01-16 20:41:02]: total number of valid data samples: 294
[2019-01-16 20:41:02]: finish loading test data from: ../../../data_voice_separation/DSD100/h5/valid.h5
[2019-01-16 20:41:02]: total number of test data samples: 294
[2019-01-16 20:41:02]: train the model
[2019-01-16 20:41:02]: --------------------------------------------------
[2019-01-16 20:41:02]: training condition:
[2019-01-16 20:41:02]: --------------------------------------------------
[2019-01-16 20:41:02]: batch size: 32
[2019-01-16 20:41:02]: interations per epoch: 35
[2019-01-16 20:41:02]: number of epoch: 10
[2019-01-16 20:41:02]: max number of interations: 350
[2019-01-16 20:41:02]: display train loss every 5 interations
[2019-01-16 20:41:02]: compute valid loss every 10 interations
[2019-01-16 20:41:02]: --------------------------------------------------
[2019-01-16 20:43:03]: iter: 5 of 350, train loss: 0.1764
[2019-01-16 20:44:22]: iter: 10 of 350, train loss: 0.1588
[2019-01-16 20:44:22]: computing loss on valid data ...
[2019-01-16 20:45:11]: current valid loss: 0.1701 (best: inf)
[2019-01-16 20:45:11]: saving the model at iter: 10
[2019-01-16 20:45:12]: model saved as ../exp/001/model.h5
[2019-01-16 20:46:36]: iter: 15 of 350, train loss: 0.1528
[2019-01-16 20:47:55]: iter: 20 of 350, train loss: 0.1515
[2019-01-16 20:47:55]: computing loss on valid data ...
[2019-01-16 20:48:45]: current valid loss: 0.1610 (best: 0.1701)
[2019-01-16 20:48:45]: saving the model at iter: 20
[2019-01-16 20:48:46]: model saved as ../exp/001/model.h5
[2019-01-16 20:50:04]: iter: 25 of 350, train loss: 0.1529
[2019-01-16 20:51:24]: iter: 30 of 350, train loss: 0.1518
[2019-01-16 20:51:24]: computing loss on valid data ...
[2019-01-16 20:52:15]: current valid loss: 0.1612 (best: 0.1610)
[2019-01-16 20:53:35]: iter: 35 of 350, train loss: 0.1510
[2019-01-16 20:54:54]: iter: 40 of 350, train loss: 0.1498
[2019-01-16 20:54:54]: computing loss on valid data ...
[2019-01-16 20:55:45]: current valid loss: 0.1617 (best: 0.1610)
[2019-01-16 20:57:05]: iter: 45 of 350, train loss: 0.1501
[2019-01-16 20:58:24]: iter: 50 of 350, train loss: 0.1499
[2019-01-16 20:58:24]: computing loss on valid data ...
[2019-01-16 20:59:13]: current valid loss: 0.1628 (best: 0.1610)
[2019-01-16 21:00:33]: iter: 55 of 350, train loss: 0.1498
[2019-01-16 21:01:52]: iter: 60 of 350, train loss: 0.1500
[2019-01-16 21:01:52]: computing loss on valid data ...
[2019-01-16 21:02:41]: current valid loss: 0.1616 (best: 0.1610)
[2019-01-16 21:04:02]: iter: 65 of 350, train loss: 0.1495
[2019-01-16 21:05:25]: iter: 70 of 350, train loss: 0.1486
[2019-01-16 21:05:25]: computing loss on valid data ...
[2019-01-16 21:06:16]: current valid loss: 0.1616 (best: 0.1610)
[2019-01-16 21:07:35]: iter: 75 of 350, train loss: 0.1481
[2019-01-16 21:08:53]: iter: 80 of 350, train loss: 0.1483
[2019-01-16 21:08:53]: computing loss on valid data ...
[2019-01-16 21:09:42]: current valid loss: 0.1602 (best: 0.1610)
[2019-01-16 21:09:42]: saving the model at iter: 80
[2019-01-16 21:09:43]: model saved as ../exp/001/model.h5
[2019-01-16 21:11:03]: iter: 85 of 350, train loss: 0.1482
[2019-01-16 21:12:22]: iter: 90 of 350, train loss: 0.1479
[2019-01-16 21:12:22]: computing loss on valid data ...
[2019-01-16 21:13:10]: current valid loss: 0.1597 (best: 0.1602)
[2019-01-16 21:13:10]: saving the model at iter: 90
[2019-01-16 21:13:11]: model saved as ../exp/001/model.h5
[2019-01-16 21:14:30]: iter: 95 of 350, train loss: 0.1479
[2019-01-16 21:15:48]: iter: 100 of 350, train loss: 0.1478
[2019-01-16 21:15:48]: computing loss on valid data ...
[2019-01-16 21:16:39]: current valid loss: 0.1603 (best: 0.1597)
[2019-01-16 21:18:00]: iter: 105 of 350, train loss: 0.1477
[2019-01-16 21:19:19]: iter: 110 of 350, train loss: 0.1476
[2019-01-16 21:19:19]: computing loss on valid data ...
[2019-01-16 21:20:08]: current valid loss: 0.1609 (best: 0.1597)
[2019-01-16 21:21:28]: iter: 115 of 350, train loss: 0.1475
[2019-01-16 21:22:46]: iter: 120 of 350, train loss: 0.1476
[2019-01-16 21:22:46]: computing loss on valid data ...
[2019-01-16 21:23:34]: current valid loss: 0.1603 (best: 0.1597)
[2019-01-16 21:24:56]: iter: 125 of 350, train loss: 0.1476
[2019-01-16 21:26:14]: iter: 130 of 350, train loss: 0.1476
[2019-01-16 21:26:14]: computing loss on valid data ...
[2019-01-16 21:27:03]: current valid loss: 0.1602 (best: 0.1597)
[2019-01-16 21:28:23]: iter: 135 of 350, train loss: 0.1475
[2019-01-16 21:29:43]: iter: 140 of 350, train loss: 0.1471
[2019-01-16 21:29:43]: computing loss on valid data ...
[2019-01-16 21:30:30]: current valid loss: 0.1586 (best: 0.1597)
[2019-01-16 21:30:30]: saving the model at iter: 140
[2019-01-16 21:30:31]: model saved as ../exp/001/model.h5
[2019-01-16 21:31:50]: iter: 145 of 350, train loss: 0.1473
[2019-01-16 21:33:08]: iter: 150 of 350, train loss: 0.1471
[2019-01-16 21:33:08]: computing loss on valid data ...
[2019-01-16 21:33:56]: current valid loss: 0.1601 (best: 0.1586)
[2019-01-16 21:35:15]: iter: 155 of 350, train loss: 0.1471
[2019-01-16 21:36:34]: iter: 160 of 350, train loss: 0.1473
[2019-01-16 21:36:34]: computing loss on valid data ...
[2019-01-16 21:37:22]: current valid loss: 0.1587 (best: 0.1586)
[2019-01-16 21:38:42]: iter: 165 of 350, train loss: 0.1472
[2019-01-16 21:40:03]: iter: 170 of 350, train loss: 0.1472
[2019-01-16 21:40:03]: computing loss on valid data ...
[2019-01-16 21:40:54]: current valid loss: 0.1598 (best: 0.1586)
[2019-01-16 21:42:13]: iter: 175 of 350, train loss: 0.1467
[2019-01-16 21:43:33]: iter: 180 of 350, train loss: 0.1465
[2019-01-16 21:43:33]: computing loss on valid data ...
[2019-01-16 21:44:23]: current valid loss: 0.1602 (best: 0.1586)
[2019-01-16 21:45:43]: iter: 185 of 350, train loss: 0.1464
[2019-01-16 21:47:02]: iter: 190 of 350, train loss: 0.1464
[2019-01-16 21:47:02]: computing loss on valid data ...
[2019-01-16 21:47:53]: current valid loss: 0.1577 (best: 0.1586)
[2019-01-16 21:47:53]: saving the model at iter: 190
[2019-01-16 21:47:53]: model saved as ../exp/001/model.h5
[2019-01-16 21:49:13]: iter: 195 of 365, train loss: 0.1462
[2019-01-16 21:50:32]: iter: 200 of 365, train loss: 0.1463
[2019-01-16 21:50:32]: computing loss on valid data ...
[2019-01-16 21:51:22]: current valid loss: 0.1589 (best: 0.1577)
[2019-01-16 21:52:42]: iter: 205 of 365, train loss: 0.1464
[2019-01-16 21:54:01]: iter: 210 of 365, train loss: 0.1462
[2019-01-16 21:54:01]: computing loss on valid data ...
[2019-01-16 21:54:52]: current valid loss: 0.1582 (best: 0.1577)
[2019-01-16 21:56:12]: iter: 215 of 365, train loss: 0.1462
[2019-01-16 21:57:31]: iter: 220 of 365, train loss: 0.1462
[2019-01-16 21:57:31]: computing loss on valid data ...
[2019-01-16 21:58:20]: current valid loss: 0.1591 (best: 0.1577)
[2019-01-16 21:59:38]: iter: 225 of 365, train loss: 0.1462
[2019-01-16 22:00:57]: iter: 230 of 365, train loss: 0.1461
[2019-01-16 22:00:57]: computing loss on valid data ...
[2019-01-16 22:01:47]: current valid loss: 0.1582 (best: 0.1577)
[2019-01-16 22:03:07]: iter: 235 of 365, train loss: 0.1461
[2019-01-16 22:04:29]: iter: 240 of 365, train loss: 0.1461
[2019-01-16 22:04:29]: computing loss on valid data ...
[2019-01-16 22:05:19]: current valid loss: 0.1588 (best: 0.1577)
[2019-01-16 22:06:39]: iter: 245 of 365, train loss: 0.1458
[2019-01-16 22:07:59]: iter: 250 of 365, train loss: 0.1458
[2019-01-16 22:07:59]: computing loss on valid data ...
[2019-01-16 22:08:49]: current valid loss: 0.1591 (best: 0.1577)
[2019-01-16 22:10:09]: iter: 255 of 365, train loss: 0.1456
[2019-01-16 22:11:28]: iter: 260 of 365, train loss: 0.1455
[2019-01-16 22:11:28]: computing loss on valid data ...
[2019-01-16 22:12:17]: current valid loss: 0.1579 (best: 0.1577)
[2019-01-16 22:13:35]: iter: 265 of 365, train loss: 0.1456
[2019-01-16 22:14:54]: iter: 270 of 365, train loss: 0.1455
[2019-01-16 22:14:54]: computing loss on valid data ...
[2019-01-16 22:15:44]: current valid loss: 0.1586 (best: 0.1577)
[2019-01-16 22:17:03]: iter: 275 of 365, train loss: 0.1455
[2019-01-16 22:18:22]: iter: 280 of 365, train loss: 0.1453
[2019-01-16 22:18:22]: computing loss on valid data ...
[2019-01-16 22:19:12]: current valid loss: 0.1580 (best: 0.1577)
[2019-01-16 22:20:29]: iter: 285 of 365, train loss: 0.1454
[2019-01-16 22:21:47]: iter: 290 of 365, train loss: 0.1453
[2019-01-16 22:21:47]: computing loss on valid data ...
[2019-01-16 22:22:35]: current valid loss: 0.1581 (best: 0.1577)
[2019-01-16 22:23:57]: iter: 295 of 365, train loss: 0.1452
[2019-01-16 22:25:16]: iter: 300 of 365, train loss: 0.1451
[2019-01-16 22:25:16]: computing loss on valid data ...
[2019-01-16 22:26:05]: current valid loss: 0.1579 (best: 0.1577)
[2019-01-16 22:27:25]: iter: 305 of 365, train loss: 0.1452
[2019-01-16 22:28:44]: iter: 310 of 365, train loss: 0.1452
[2019-01-16 22:28:44]: computing loss on valid data ...
[2019-01-16 22:29:33]: current valid loss: 0.1587 (best: 0.1577)
[2019-01-16 22:30:53]: iter: 315 of 365, train loss: 0.1449
[2019-01-16 22:32:13]: iter: 320 of 365, train loss: 0.1449
[2019-01-16 22:32:13]: computing loss on valid data ...
[2019-01-16 22:33:00]: current valid loss: 0.1575 (best: 0.1577)
[2019-01-16 22:33:00]: saving the model at iter: 320
[2019-01-16 22:33:01]: model saved as ../exp/001/model.h5
[2019-01-16 22:34:20]: iter: 325 of 495, train loss: 0.1449
[2019-01-16 22:35:40]: iter: 330 of 495, train loss: 0.1449
[2019-01-16 22:35:40]: computing loss on valid data ...
[2019-01-16 22:36:27]: current valid loss: 0.1574 (best: 0.1575)
[2019-01-16 22:36:27]: saving the model at iter: 330
[2019-01-16 22:36:28]: model saved as ../exp/001/model.h5
[2019-01-16 22:37:47]: iter: 335 of 505, train loss: 0.1449
[2019-01-16 22:39:06]: iter: 340 of 505, train loss: 0.1447
[2019-01-16 22:39:06]: computing loss on valid data ...
[2019-01-16 22:39:54]: current valid loss: 0.1587 (best: 0.1574)
[2019-01-16 22:41:14]: iter: 345 of 505, train loss: 0.1445
[2019-01-16 22:42:33]: iter: 350 of 505, train loss: 0.1446
[2019-01-16 22:42:33]: computing loss on valid data ...
[2019-01-16 22:43:23]: current valid loss: 0.1578 (best: 0.1574)
[2019-01-16 22:44:47]: iter: 355 of 505, train loss: 0.1445
[2019-01-16 22:46:06]: iter: 360 of 505, train loss: 0.1444
[2019-01-16 22:46:06]: computing loss on valid data ...
[2019-01-16 22:46:57]: current valid loss: 0.1586 (best: 0.1574)
[2019-01-16 22:48:16]: iter: 365 of 505, train loss: 0.1443
[2019-01-16 22:49:35]: iter: 370 of 505, train loss: 0.1445
[2019-01-16 22:49:35]: computing loss on valid data ...
[2019-01-16 22:50:23]: current valid loss: 0.1568 (best: 0.1574)
[2019-01-16 22:50:23]: saving the model at iter: 370
[2019-01-16 22:50:24]: model saved as ../exp/001/model.h5
[2019-01-16 22:51:44]: iter: 375 of 545, train loss: 0.1445
[2019-01-16 22:53:03]: iter: 380 of 545, train loss: 0.1445
[2019-01-16 22:53:03]: computing loss on valid data ...
[2019-01-16 22:53:52]: current valid loss: 0.1586 (best: 0.1568)
[2019-01-16 22:55:13]: iter: 385 of 545, train loss: 0.1442
[2019-01-16 22:56:32]: iter: 390 of 545, train loss: 0.1441
[2019-01-16 22:56:32]: computing loss on valid data ...
[2019-01-16 22:57:22]: current valid loss: 0.1579 (best: 0.1568)
[2019-01-16 22:58:43]: iter: 395 of 545, train loss: 0.1441
[2019-01-16 23:00:04]: iter: 400 of 545, train loss: 0.1441
[2019-01-16 23:00:04]: computing loss on valid data ...
[2019-01-16 23:00:55]: current valid loss: 0.1581 (best: 0.1568)
[2019-01-16 23:02:16]: iter: 405 of 545, train loss: 0.1441
[2019-01-16 23:03:37]: iter: 410 of 545, train loss: 0.1440
[2019-01-16 23:03:37]: computing loss on valid data ...
[2019-01-16 23:04:30]: current valid loss: 0.1593 (best: 0.1568)
[2019-01-16 23:05:52]: iter: 415 of 545, train loss: 0.1439
[2019-01-16 23:07:12]: iter: 420 of 545, train loss: 0.1439
[2019-01-16 23:07:12]: computing loss on valid data ...
[2019-01-16 23:08:03]: current valid loss: 0.1603 (best: 0.1568)
[2019-01-16 23:09:24]: iter: 425 of 545, train loss: 0.1438
[2019-01-16 23:10:45]: iter: 430 of 545, train loss: 0.1438
[2019-01-16 23:10:45]: computing loss on valid data ...
[2019-01-16 23:11:34]: current valid loss: 0.1572 (best: 0.1568)
[2019-01-16 23:12:54]: iter: 435 of 545, train loss: 0.1438
[2019-01-16 23:14:13]: iter: 440 of 545, train loss: 0.1437
[2019-01-16 23:14:13]: computing loss on valid data ...
[2019-01-16 23:15:02]: current valid loss: 0.1595 (best: 0.1568)
[2019-01-16 23:16:24]: iter: 445 of 545, train loss: 0.1437
[2019-01-16 23:17:43]: iter: 450 of 545, train loss: 0.1436
[2019-01-16 23:17:43]: computing loss on valid data ...
[2019-01-16 23:18:35]: current valid loss: 0.1586 (best: 0.1568)
[2019-01-16 23:19:55]: iter: 455 of 545, train loss: 0.1437
[2019-01-16 23:21:14]: iter: 460 of 545, train loss: 0.1437
[2019-01-16 23:21:14]: computing loss on valid data ...
[2019-01-16 23:22:03]: current valid loss: 0.1591 (best: 0.1568)
[2019-01-16 23:23:25]: iter: 465 of 545, train loss: 0.1436
[2019-01-16 23:24:48]: iter: 470 of 545, train loss: 0.1436
[2019-01-16 23:24:48]: computing loss on valid data ...
[2019-01-16 23:25:37]: current valid loss: 0.1578 (best: 0.1568)
[2019-01-16 23:26:57]: iter: 475 of 545, train loss: 0.1436
[2019-01-16 23:28:17]: iter: 480 of 545, train loss: 0.1436
[2019-01-16 23:28:17]: computing loss on valid data ...
[2019-01-16 23:29:07]: current valid loss: 0.1580 (best: 0.1568)
[2019-01-16 23:30:27]: iter: 485 of 545, train loss: 0.1436
[2019-01-16 23:31:46]: iter: 490 of 545, train loss: 0.1434
[2019-01-16 23:31:46]: computing loss on valid data ...
[2019-01-16 23:32:36]: current valid loss: 0.1577 (best: 0.1568)
[2019-01-16 23:33:57]: iter: 495 of 545, train loss: 0.1435
[2019-01-16 23:35:16]: iter: 500 of 545, train loss: 0.1435
[2019-01-16 23:35:16]: computing loss on valid data ...
[2019-01-16 23:35:53]: current valid loss: 0.1590 (best: 0.1568)
[2019-01-16 23:36:54]: iter: 505 of 545, train loss: 0.1435
[2019-01-16 23:37:58]: iter: 510 of 545, train loss: 0.1435
[2019-01-16 23:37:58]: computing loss on valid data ...
[2019-01-16 23:38:49]: current valid loss: 0.1583 (best: 0.1568)
[2019-01-16 23:40:07]: iter: 515 of 545, train loss: 0.1433
[2019-01-16 23:41:26]: iter: 520 of 545, train loss: 0.1434
[2019-01-16 23:41:26]: computing loss on valid data ...
[2019-01-16 23:42:13]: current valid loss: 0.1570 (best: 0.1568)
[2019-01-16 23:43:30]: iter: 525 of 545, train loss: 0.1432
[2019-01-16 23:44:46]: iter: 530 of 545, train loss: 0.1431
[2019-01-16 23:44:46]: computing loss on valid data ...
[2019-01-16 23:45:33]: current valid loss: 0.1593 (best: 0.1568)
[2019-01-16 23:46:47]: iter: 535 of 545, train loss: 0.1431
[2019-01-16 23:48:02]: iter: 540 of 545, train loss: 0.1431
[2019-01-16 23:48:02]: computing loss on valid data ...
[2019-01-16 23:48:46]: current valid loss: 0.1578 (best: 0.1568)
[2019-01-16 23:49:47]: training is done
[2019-01-16 23:49:47]: ================================================
